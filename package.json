{
  "name": "hdl-helper",
  "displayName": "HDL Helper",
  "description": "FPGA/IC 全能助手：双引擎语法检查 (Vivado/Verible)、一键格式化、自动 Testbench、智能例化、LSP 跳转与大纲。",
  "version": "2.3.4",
  "publisher": "Cyrus",
  "engines": {
    "vscode": "^1.108.0"
  },
  "categories": [
    "Programming Languages",
    "Linters",
    "Formatters",
    "Snippets"
  ],
  "icon": "images/icon_min.png",
  "main": "./out/extension.js",
  "repository": {
    "type": "git",
    "url": "https://github.com/Aligo-BTBKS/hdl-helper"
  },
  "contributes": {
    "commands": [
      {
        "command": "hdl-helper.instantiate",
        "title": "HDL: Instantiate Module",
        "category": "HDL Helper"
      },
      {
        "command": "hdl-helper.createSignals",
        "title": "HDL: Create Signal Declarations",
        "category": "HDL Helper"
      },
      {
        "command": "hdl-helper.generateTB",
        "title": "HDL: Generate Testbench",
        "category": "HDL Helper"
      },
      {
        "command": "hdl-helper.debugProject",
        "title": "HDL: Debug Project",
        "category": "HDL Helper"
      },
      {
        "command": "hdl-helper.setTopModule",
        "title": "HDL: Set as Top Module",
        "category": "HDL Helper"
      },
      {
        "command": "hdl-helper.clearTopModule",
        "title": "HDL: Clear Top Module",
        "category": "HDL Helper",
        "icon": "$(clear-all)" 
      },
      {
         "command": "hdl-helper.copyInstantiation",
         "title": "HDL: Copy Instantiation Template",
         "category": "HDL Helper"
      },
      {
        "command": "hdl-helper.generateDoc",
        "title": "HDL: Generate Interface Doc",
        "category": "HDL Helper"
      },
      {
        "command": "hdl-helper.listLintRules",
        "title": "HDL: List All Linter Rules",
        "category": "HDL Helper" 
      }
    ],
    "configuration": {
      "title": "HDL Helper",
      "properties": {
        "hdl-helper.signalType": {
          "type": "string",
          "enum": [
            "wire",
            "logic",
            "reg"
          ],
          "default": "logic",
          "description": "自动声明信号时使用的类型 (Auto-declare signal type)"
        },
        "hdl-helper.linter.tool": {
          "type": "string",
          "enum": [
            "xvlog",
            "verible-lint"
          ],
          "default": "xvlog",
          "description": "选择语法检查工具 (Select Linter Tool): 'xvlog' (Vivado) or 'verible-lint' (Google Verible)."
        },
        "hdl-helper.linter.veriblePath": {
          "type": "string",
          "default": "verible-verilog-lint",
          "description": "Path to verible-verilog-lint executable."
        },
        "hdl-helper.linter.executablePath": {
          "type": "string",
          "default": "xvlog",
          "description": "Linter 可执行文件路径 (例如: D:\\Xilinx\\Vivado\\2022.1\\bin\\xvlog.bat)。如果已在 PATH 中，保留默认值 'xvlog' 即可。",
          "scope": "resource"
        },
        "hdl-helper.formatter.executablePath": {
          "type": "string",
          "default": "verible-verilog-format",
          "description": "Verible 格式化工具的路径 (Path to verible-verilog-format executable).",
          "scope": "resource"
        },
        "hdl-helper.languageServer.enabled": {
          "type": "boolean",
          "default": true,
          "description": "Enable Verible Language Server (LSP)."
        },
        "hdl-helper.languageServer.path": {
          "type": "string",
          "default": "verible-verilog-ls",
          "description": "Path to verible-verilog-ls executable."
        },
        "hdl-helper.linter.rules": {
          "type": "object",
          "markdownDescription": "Verible Linter 规则配置。Key 是规则名，Value 可以是 `true`(启用), `false`(禁用/屏蔽), 或 `string`(传递参数)。\n\n查看所有规则请运行命令: **HDL Helper: List All Linter Rules**",
          "default": {
              "no-trailing-spaces": true,
              "no-tabs": true,
              "line-length": "length:150"
          },
          "properties": {
              "line-length": {
                  "type": "string",
                  "markdownDescription": "行宽限制规则。例如: `length:120`。如果想禁用此检查，请设为 `false`。"
              },
              "no-tabs": {
                  "type": "boolean",
                  "description": "禁止使用 Tab 键缩进，强制使用空格。"
              },
              "no-trailing-spaces": {
                  "type": "boolean",
                  "description": "禁止行尾出现多余空格。"
              },
              "parameter-name-style": {
                  "type": "string",
                  "markdownDescription": "参数命名风格。例如: `localparam_style:CamelCase`"
              },
              "always-comb": {
                  "type": "boolean",
                  "description": "检查是否使用 always_comb 代替 always @(*)。"
              }
          },
          "additionalProperties": {
              "anyOf": [
                  { "type": "boolean" },
                  { "type": "string" }
              ],
              "markdownDescription": "在此处添加其他 Verible 规则。例如 `\"case-missing-default\": true`"
          }
        }
      }
    },
    "viewsContainers": {
      "activitybar": [
        {
          "id": "hdl-explorer",
          "title": "HDL Explorer",
          "icon": "$(chip)" 
        }
      ]
    },
    "views": {
      "hdl-explorer": [
        {
          "id": "hdl-hierarchy-view",
          "name": "Module Hierarchy",
          "icon": "images/icon_min.png"
        }
      ]
    },
    "keybindings": [
      {
        "command": "hdl-helper.instantiate",
        "key": "ctrl+alt+i",
        "mac": "cmd+alt+i",
        "when": "editorTextFocus && (resourceLangId == verilog || resourceLangId == systemverilog)"
      },
      {
        "command": "hdl-helper.createSignals",
        "key": "ctrl+alt+w",
        "mac": "cmd+alt+w",
        "when": "editorTextFocus && (resourceLangId == verilog || resourceLangId == systemverilog)"
      },
      {
        "command": "hdl-helper.generateTB",
        "key": "ctrl+alt+t",
        "mac": "cmd+alt+t",
        "when": "editorTextFocus && (resourceLangId == verilog || resourceLangId == systemverilog)"
      }
    ],
    "menus": {
      "editor/context": [
        {
          "command": "hdl-helper.instantiate",
          "group": "hdl-group@1",
          "when": "editorTextFocus && (resourceLangId == verilog || resourceLangId == systemverilog)"
        },
        {
          "command": "hdl-helper.createSignals",
          "group": "hdl-group@2",
          "when": "editorTextFocus && (resourceLangId == verilog || resourceLangId == systemverilog)"
        },
        {
          "command": "hdl-helper.generateTB",
          "group": "hdl-group@3",
          "when": "editorTextFocus && (resourceLangId == verilog || resourceLangId == systemverilog)"
        }
      ],
      "view/title": [
        {
          "command": "hdl-helper.clearTopModule",
          "when": "view == hdl-hierarchy-view",
          "group": "navigation"
        }
      ],
      "view/item/context": [
        {
          "command": "hdl-helper.setTopModule",
          "when": "view == hdl-hierarchy-view && viewItem == module",
          "group": "1_modification" 
        },
        {
          "command": "hdl-helper.clearTopModule",
          "when": "view == hdl-hierarchy-view",
          "group": "1_modification"
        },
        {
          "command": "hdl-helper.copyInstantiation",
          "when": "view == hdl-hierarchy-view && viewItem == module",
          "group": "2_codegen"
        },
        {
          "command": "hdl-helper.generateTB",
          "when": "view == hdl-hierarchy-view && viewItem == module",
          "group": "2_codegen"
        },
        {
          "command": "hdl-helper.generateDoc",
          "when": "view == hdl-hierarchy-view && viewItem == module",
          "group": "3_documentation"
        }
      ]
    },
    "snippets": [
      {
        "language": "verilog",
        "path": "./snippets/hdl.json"
      },
      {
        "language": "systemverilog",
        "path": "./snippets/hdl.json"
      }
    ],
    "languages": [
      {
        "id": "verilog",
        "aliases": [
          "Verilog",
          "v"
        ],
        "extensions": [
          ".v",
          ".vh",
          ".vl"
        ],
        "configuration": "./language-configuration.json"
      },
      {
        "id": "systemverilog",
        "aliases": [
          "SystemVerilog",
          "sv"
        ],
        "extensions": [
          ".sv",
          ".svh",
          ".sva"
        ],
        "configuration": "./language-configuration.json"
      }
    ],
    "grammars": [
      {
        "language": "verilog",
        "scopeName": "source.verilog",
        "path": "./syntaxes/verilog.tmLanguage.json"
      },
      {
        "language": "systemverilog",
        "scopeName": "source.systemverilog",
        "path": "./syntaxes/systemverilog.tmLanguage.json"
      }
    ]
  },
  "scripts": {
    "vscode:prepublish": "npm run compile",
    "compile": "tsc -p ./",
    "watch": "tsc -watch -p ./",
    "pretest": "npm run compile && npm run lint",
    "lint": "eslint src",
    "test": "vscode-test"
  },
  "dependencies": {
    "vscode-jsonrpc": "^8.2.0",
    "vscode-languageclient": "^9.0.1"
  },
  "devDependencies": {
    "@types/mocha": "^10.0.10",
    "@types/node": "22.x",
    "@types/vscode": "^1.108.1",
    "@vscode/test-cli": "^0.0.11",
    "@vscode/test-electron": "^2.5.2",
    "eslint": "^9.39.2",
    "typescript": "^5.9.3",
    "typescript-eslint": "^8.52.0"
  }
}
